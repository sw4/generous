angular.module("generous",["hljs"]).run(["$rootScope","$location","$anchorScroll","$timeout",function(e,n,o,t){t(function(){o()},!1),e.$on("$routeChangeSuccess",function(){n.hash()&&o()})}]).directive("generousLogo",[function(){return{restrict:"E",replace:!0,template:"<span class='gen__logo'><span class='gen__logoShardGroup gen__logoShardGroup1'><span class='gen__logoShard gen__logoShard1'></span><span class='gen__logoShard gen__logoShard2'></span><span class='gen__logoShard gen__logoShard3'></span><span class='gen__logoShard gen__logoShard4'></span></span><span class='gen__logoShardGroup gen__logoShardGroup2'><span class='gen__logoShard gen__logoShard1'></span><span class='gen__logoShard gen__logoShard2'></span><span class='gen__logoShard gen__logoShard3'></span><span class='gen__logoShard gen__logoShard4'></span></span></span>"}}]).directive("generousExample",["$timeout","$http","$q",function(e,n,o){return{restrict:"E",replace:!0,scope:{source:"="},template:"<section><p ng-if='source.description'>{{source.description}}<br /><br /></p><ul class='tabset__tabs list--inline'><li ng-repeat='(key,val) in tabs track by $index' ng-click='setTab($index)' ng-class='{\"tab--active\":showTab===$index}'>{{key}}</li></ul><iframe id='gen__exampleOutput' ng-show='showTab === 0'></iframe><div ng-repeat='tab in tabs track by $index' ng-if='showTab === $index && $index > 0' hljs hljs-linums source='tab' class='gen__exampleSnippet'>{{tab}}</div></section>",link:function(e,t){function a(e){return e=e||0,e===g.length?void s():void(g[e]&&r(g[e]).then(function(){a(e+1)}))}function r(t){var a=o.defer(),r=i.contentWindow.document.createElement("script");return r.type="text/javascript",t.hasAttribute("embed")&&t.src?n.get(t.src).then(function(n){e.getExampleLoadingMsg.push({text:"Loading "+t.src}),r.text=n.data,a.resolve(r)},function(n){e.getExampleLoadingMsg.push({text:"Failed to load "+url,error:!0}),a.reject(n)}):t.src?(r.src=t.src,angular.element(r).on("load",function(e){a.resolve(r)})):(r.innerHTML="string"==typeof t?t:t.innerHTML,a.resolve(r)),c.appendChild(r),a.promise}function s(){if(angular.element(document.getElementById("gen__logo")).removeClass("gen__anim_phaseOut gen__anim_loop"),e.source.javascript&&(e.getExampleLoadingMsg.push({text:"Javascript loaded"}),r(e.source.javascript)),e.source.css){e.getExampleLoadingMsg.push({text:"CSS loaded"});var n=document.createElement("style");n.innerHTML=e.source.css,c.appendChild(n)}e.source.html&&(e.getExampleLoadingMsg.push({text:"HTML loaded"}),u.innerHTML=e.source.html),e.genExampleLoaded=!0,i.style.height=u.scrollHeight+25+"px",i.style.opacity="1"}e.tabs={},e.setTab=function(n){n=n||0,e.showTab=n},e.setTab(),e.tabs.output="<iframe id='gen__exampleOutput'></iframe>";for(var l in angular.copy(e.source))e.source.hasOwnProperty(l)&&"description"!==l&&(e.tabs[l]=e.source[l]);e.genExampleLoaded=!1,e.getExampleLoadingMsg=[];var i=t[0].getElementsByTagName("iframe")[0],c=i.contentDocument.head,u=i.contentDocument.body,g=[];if(i.style.opacity="0",e.source.head){e.getExampleLoadingMsg.push({text:"Loading HEAD content"});var p=document.createElement("div");p.innerHTML=e.source.head;for(var d=0;d<p.children.length;d++)"script"!==p.children[d].tagName.toLowerCase()?c.appendChild(p.children[d]):g.push(p.children[d])}a()}}}]).service("errorSvc",function(){return{init:function(e){e.errorSvc={errors:{}},this.scope=e},handle:function(e,n,o){console=console||{log:function(){}},console.log("Generous has encountered an error: ",e,n),this.scope.errorSvc.errors[e]="object"==typeof n?JSON.stringify(n):n},dismiss:function(e){delete this.scope.errorSvc.errors[e]}}}).filter("trusted",["$sce",function(e){return function(n){return e.trustAsHtml(n)}}]).config(["hljsServiceProvider",function(e){e.setOptions({tabReplace:"    "})}]).service("smoothScroll",function(){return{scroll:function(e,n){e=e[0]?e[0]:e;var o=e.scrollTop,t=n,a=t-o,r=100,s=15,l=0>t-o?-1*s:s,i=r/(a/l),c=0,u=null;e.scrollTop!==t&&(u=setInterval(function(){e.scrollTop=e.scrollTop+l,c+=i,c>=r&&(e.scrollTop=t,clearInterval(u))},i))}}}).directive("genMarkdown",["$timeout",function(e){return{restrict:"A",scope:{genMarkdown:"="},link:function(e,n){n.addClass("gen__markdown"),e.$watch("genMarkdown",function(e,o){n[0].innerHTML=marked(e)})}}}]).directive("genAnchor",["$compile","$location",function(e,n){return{restrict:"E",replace:!0,transclude:!0,scope:{genAnchor:"=?link"},template:"<a id='{{genAnchor}}' href ng-click='setAnchor(genAnchor)' class='gen__anchor'><i class='gen__icon icon__link'></i><span ng-transclude></span></a>",link:function(e,o,t){function a(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,n){return 0===n?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")}e.genAnchor=e.genAnchor||a(o[0].innerText),e.setAnchor=function(e){n.hash(e)}}}}]).directive("hljsLinums",["$timeout",function(e){return{restrict:"A",scope:{linums:"=hljsLinums",source:"="},compile:function(){return{pre:function(e,n){function o(){function n(e){angular.element(s[0].children[parseInt(e,0)]).addClass("hljs-highlight")}s.find("li").removeClass("hljs-highlight");for(var o=0;o<e.linums.length;o++)if(e.linums[o].indexOf("-")>-1){var t=e.linums[o].split("-");t[0]=parseInt(t[0].replace("'","").replace('"',""),0),t[1]=parseInt(t[1].replace("'","").replace('"',""),0);for(var a=t[0]-1;a<t[1];a++)n(a)}else n(highlight[o])}e.$watch("linums",function(e,n){e&&e!==n&&o()});var t,a,r=n[0].getElementsByTagName("code")[0],s=angular.element('<ul class="hljs-linum-numbers"/>');angular.element(n[0].getElementsByTagName("code")).parent().append(s),e.$watch("source",function(n,r){if(void 0!==n){for(t=e.source,a=t.split("\n").length,s.find("li").remove(),i=1;i<=a;i++)s.append(angular.element("<li/>").text(i));e.linums&&o()}}),n.addClass("hljs-linums"),angular.element(r).on("scroll",function(){s[0].style.top=-1*r.scrollTop+"px"})}}}}}]).service("debounce",["$timeout",function(e){return function(n,o,t,a){var r=null;a=a||100,n=n[0]?n:angular.element(n),n.on(o,function(){r&&clearTimeout(r),r=setTimeout(function(){e(t,!1),clearTimeout(r)},a)})}}]).controller("generousCtrl",["$http","$scope","$location","$timeout","smoothScroll","debounce","errorSvc",function(e,n,o,t,a,r,s){function l(e,o,t){if(n.genSearch=[],!e)return void(n.genSearchActive=!1);e=e.toLowerCase(),o=o||["name","description","type"],t=t||n.hashTable;for(var a in t)if(t.hasOwnProperty(a)){var r=!1;o.forEach(function(n){t[a][n]&&t[a][n].toString().toLowerCase().indexOf(e)>-1&&(r=!0)}),r&&n.genSearch.push(t[a])}n.genSearchActive=!0}function i(){var e=document.getElementById("gen__sourceView");if(e){e=e.getElementsByTagName("code")[0];var o=parseInt(window.getComputedStyle(e,null).getPropertyValue("line-height"),0);e.scrollLeft=0,a.scroll(e,o*n.view[n.model.options.denominator].line.from-2*o)}}function c(e,o){for(var t="",a=0;a<e.length;a++)t=void 0===o?e[a].shortName:o+"/"+e[a].shortName,e[a].hash=t,n.hashTable[t]=e[a],n.sourceMap[e[a][n.model.options.denominator].source]||(n.sourceMap[e[a][n.model.options.denominator].source]=[]),n.sourceMap[e[a][n.model.options.denominator].source].push(t),e[a].children?c(e[a].children,t):t=""}function u(){for(var e=n.view.hash,o=e.split("/"),t=o.length,a=[],r=0;t>r;r++)e=o.join("/"),a.push({hash:e,name:n.hashTable[e].name}),o.pop();n.breadcrumb=a.reverse()}n.model=[],n.view={},n.hashTable={},n.sourceMap={},n.genSearchActive=!1,n.genSearchTerm=null;var g=angular.element(document.getElementById("genSearchInput"));r(g,"keyup",function(){l(g[0].value)},150),g.on("focus",function(){t(function(){l(g[0].value)},!1)}),g.on("blur",function(){g[0].value||t(function(){l(g[0].value)},!1)}),n.sourceEditor=function(e){function o(e,n){var o=angular.element('<form style="display: none;" method="POST" action="'+e+'" target="_blank"></form>');angular.forEach(n,function(e,n){var t=angular.element('<textarea name="'+n+'">'+e+"</textarea>");o.append(t)}),angular.element(document.body).append(o),t(function(){o[0].submit(),o.remove()},!1)}e.preventDefault();var a={},r={};n.view.example.javascript&&(a.js=n.view.example.javascript),n.view.example.css&&(a.css=n.view.example.css),a.html="<!doctype html>\n<html>\n  <head>\n",n.view.example.head&&(a.html+=n.view.example.head+"\n"),a.html+="  </head>\n  <body>\n\n",n.view.example.html&&(a.html+=n.view.example.html),a.html+="  </body>\n</html>\n";var s,l=n.model.options.sourceEditor.toLowerCase().replace(/\s/g,"");switch(l){case"jsbin":s="http://jsbin.com",r=a;break;case"jsfiddle":s="http://jsfiddle.net/api/post/library/pure/",r=a;break;case"plunker":case"plnkr":default:r.description=n.view.hash,r["files[index.html]"]=a.html,a.css&&(r["files[styles.css]"]=a.css),a.js&&(r["files[javascript.js]"]=a.js),s="http://plnkr.co/edit/?p=preview"}o(s,r)},n.gdSourceCode="",n.sourceLink=function(o){return o&&n.model.options.sourceLink?o===n.genViewSource?void i():(angular.element(document.getElementById("gen__logo")).addClass("gen__anim_phaseOut gen__anim_loop"),void e.get(o).then(function(e){n.genSourceCode=e.data,n.genViewSource=o,t(function(){i()}),angular.element(document.getElementById("gen__logo")).removeClass("gen__anim_phaseOut gen__anim_loop")},function(e){angular.element(document.getElementById("gen__logo")).removeClass("gen__anim_phaseOut gen__anim_loop")})):(n.genSourceCode=null,void(n.genViewSource=!1))},n.updateView=function(e){"string"==typeof e&&(e=n.hashTable[e.replace(/^\//,"")]),o.path(e.hash),n.view=angular.copy(e),n.genSourceLines=[n.view[n.model.options.denominator].line.from+"-"+n.view.generous.line.to],u(),n.genViewSource&&n.sourceLink(e[n.model.options.denominator].source),t(function(){n.genSearchActive=!1},!1)},s.init(n),angular.element(document.getElementById("gen__logo")).addClass("gen__anim_phaseOut gen__anim_loop"),e.get("data/generous.json").then(function(e){angular.element(document.getElementById("gen__logo")).removeClass("gen__anim_phaseOut gen__anim_loop"),n.model=e.data,c(n.model.data),n.updateView(o.path()||n.model.data[0].hash),n.$on("$locationChangeStart",function(e,t,a){o.path()&&n.updateView(o.path())})},function(e){angular.element(document.getElementById("gen__logo")).removeClass("gen__anim_phaseOut gen__anim_loop")})}]);